<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Account - Caro Game</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="user-info">
                <img src="{{ url_for('static', filename='images/default_avatar.png') }}" class="avatar">
                <div class="user-details">
                    <h3>{{ user.displayName }}</h3>
                    <span class="coins">{{ user_coins }} <img src="{{ url_for('static', filename='images/coin.png') }}" alt="Coins"></span>
                </div>
            </div>
            
            <nav class="menu">
                <a href="{{ url_for('home.index') }}" class="menu-item">
                    <span class="icon">üè†</span>
                    <span>Trang ch·ªß</span>
                </a>
                <a href="{{ url_for('store.index') }}" class="menu-item">
                    <span class="icon">üéÅ</span>
                    <span>V·∫≠t ph·∫©m</span>
                </a>
                <a href="{{ url_for('profile.index') }}" class="menu-item active">
                    <span class="icon">üë§</span>
                    <span>H·ªì s∆°</span>
                </a>
            </nav>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="profile-container">
                <h1>T√†i kho·∫£n c·ªßa t√¥i</h1>
                
                <form action="{{ url_for('profile.update_profile') }}" method="POST" class="profile-form">
                    <div class="form-group">
                        <label for="displayName">T√™n hi·ªÉn th·ªã</label>
                        <input type="text" id="displayName" name="displayName" value="{{ user.displayName }}">
                    </div>
                    
                    <div class="form-group">
                        <label for="user_id">ID</label>
                        <div class="id-field">
                            <input type="text" id="user_id" value="{{ user.user_id }}" readonly>
                            <button type="button" class="copy-btn" onclick="copyUserId()">üìã</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Avatar hi·ªán t·∫°i</label>
                        <div class="current-avatar">
                            <img src="{{ url_for('static', filename=user.avatar if user.avatar else 'images/default_avatar.png') }}" alt="Current Avatar" class="avatar-preview">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Avatar ƒë√£ mua</label>
                        <div class="avatar-grid">
                            {% if user_avatars %}
                                {% for avatar in user_avatars %}
                                <div class="avatar-item {% if user.avatar == avatar.image_url %}active{% endif %}">
                                    <img src="{{ url_for('static', filename=avatar.image_url) }}" alt="Avatar {{ avatar.avatar_id }}">
                                    <a href="{{ url_for('profile.change_avatar', avatar_id=avatar.avatar_id) }}" class="select-avatar">Ch·ªçn</a>
                                </div>
                                {% endfor %}
                            {% else %}
                                <p class="no-items">B·∫°n ch∆∞a mua avatar n√†o. H√£y ƒë·∫øn <a href="{{ url_for('store.index') }}">C·ª≠a h√†ng</a> ƒë·ªÉ mua avatar m·ªõi!</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <button type="submit" class="btn primary-btn">C·∫≠p nh·∫≠t</button>
                </form>
                
                <div class="delete-account">
                    <h2>X√≥a t√†i kho·∫£n</h2>
                    <p>
                        Vi·ªác x√≥a t√†i kho·∫£n s·∫Ω x√≥a vƒ©nh vi·ªÖn t√†i kho·∫£n, g·ªìi ƒë·∫•u, tr√≤ 
                        ch∆°i, th·ª© h·∫°ng v√† email li√™n tr√¨ c·ªßa b·∫°n. Kh√¥ng th·ªÉ ho√†n t√°c 
                        h√†nh ƒë·ªông n√†y.
                    </p>
                    <button type="button" class="btn danger-btn" id="delete-btn">X√≥a t√†i kho·∫£n</button>
                </div>
            </div>
        </div>
        
        <!-- User Profile Sidebar -->
        <div class="profile-sidebar">
            <div class="profile-sidebar-header">
                <a href="{{ url_for('home.index') }}" class="close-btn">&times;</a>
            </div>
            
            <div class="profile-user-info">
                <h3>{{ user.username }}</h3>
                <span class="user-type">Kh√°ch m·ªùi</span>
            </div>
            
            <div class="profile-avatar">
                <img src="{{ url_for('static', filename='images/monster_avatar.png') }}" alt="Monster Avatar">
            </div>
            
            <div class="profile-game-info">
                <h3>Caro</h3>
                <div class="level-badge">C·∫•p ƒë·ªô 3</div>
                <div class="level-progress">1 / 3 / 5</div>
            </div>
        </div>
    </div>
    
    <script>
        function copyUserId() {
            const idInput = document.getElementById('user_id');
            idInput.select();
            document.execCommand('copy');
            
            // Show copied notification
            alert('ID copied to clipboard!');
        }
        
        document.getElementById('delete-btn').addEventListener('click', function() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t√†i kho·∫£n? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.')) {
                // Send request to delete account
                // For this demo, just redirect to home
                alert('T√†i kho·∫£n ƒë√£ ƒë∆∞·ª£c x√≥a.');
                window.location.href = "{{ url_for('home.index') }}";
            }
        });
    </script>
</body>
</html>